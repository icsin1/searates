<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="res_users_preferences_view_form" model="ir.ui.view">
        <field name="name">res.users.view.form</field>
        <field name="model">res.users</field>
        <field name="inherit_id" ref="base.view_users_form_simple_modif"/>
        <field name="arch" type="xml">
            <xpath expr="//notebook" position="inside">
                <page name="ms_email_setting" string="Outgoing Email Settings" attrs="{'invisible': [('ms_mail_matched', '=', False)]}">
                    <field name="ms_mail_matched" invisible="1"/>
                    <field name="ms_smtp_configured" invisible="1"/>
                    <div class="alert alert-info card" role="alert" attrs="{'invisible': [('ms_smtp_configured', '=', True)]}">
                        <h4 class="alert-heading" role="alert">You need to authorize your accout with Microsoft</h4>
                        <p class="p-0 m-0">System unable to send outgoing email from your email without authorization from Microsoft. Click below button to authorize your account with Microsoft</p>
                        <hr/>
                        <div><button class="btn btn-info btn-sm" type="object" name="action_authorize_ms_outlook">Authorize &amp; Activate</button></div>
                    </div>
                    <div class="alert alert-success card" role="alert" attrs="{'invisible': [('ms_smtp_configured', '=', False)]}">
                        <h4 class="alert-heading" role="alert">Your outgoing email is already configured and running</h4>
                        <p class="p-0 m-0">Click below button to deactivate outgoing email from the system</p>
                        <hr/>
                        <div><button class="btn btn-warning btn-sm" type="object" name="action_remove_ms_outlook" confirm="Are you sure want to deactivate?">Deactivate</button></div>
                    </div>
                </page>
            </xpath>
        </field>
    </record>

</odoo>
