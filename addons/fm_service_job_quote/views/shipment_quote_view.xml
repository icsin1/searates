<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <record id="view_shipment_quote_form" model="ir.ui.view">
        <field name="name">shipment.quote.form</field>
        <field name="model">shipment.quote</field>
        <field name="priority" eval="19"/>
        <field name="inherit_id" ref="fm_quote.view_shipment_quote_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='service_mode_id']" position="after">
                <field name="service_job_type_id"  options="{'no_open': True}" attrs="{'invisible': [('quote_for', '!=', 'job')], 'required': [('quote_for', '=', 'job')],
                    'readonly': [('id', '!=', False), ('service_job_type_id', '>', 0)]}" force_save="1"/>
                <field name="service_job_ids" invisible="1"/>
            </xpath>
            <xpath expr="//field[@name='service_mode_id']" position="attributes">
                <attribute name="attrs">{'invisible': [('quote_for', '=', 'job')]}</attribute>
            </xpath>
            <xpath expr="//field[@name='transport_mode_id']/../.." position="attributes">
                <attribute name="attrs">{'invisible': [('quote_for', '=', 'job')]}</attribute>
            </xpath>
            <xpath expr="//field[@name='shipment_quote_template_id']" position="attributes">
                <attribute name="context">{'default_transport_mode_id': transport_mode_id, 'default_shipment_type_id': shipment_type_id, 'cargo_type_ids': cargo_type_id, 'default_template_for': quote_for, 'default_service_job_type_id': service_job_type_id, 'from_quote': True}</attribute>
            </xpath>
            <xpath expr="//button[@name='action_create_shipment']" position="after">
                <button string="Convert To Service Job" name="action_create_service_job" type="object" class="oe_highlight" attrs="{'invisible': ['|', '|', '&amp;', ('shipment_count', '=', 'single'), ('service_job_ids', '!=', []), ('quote_for', '!=', 'job'), ('state', '!=', 'accept')]}"/>
            </xpath>
            <xpath expr="//button[@name='action_open_shipments']" position="before">
                <button class="oe_stat_button" name="action_open_service_job" type="object" icon="fa-bars" attrs="{'invisible': [('service_job_ids', '=', [])]}">
                    <div class="o_stat_info">
                        <span class="o_stat_text">View</span>
                        <span class="o_stat_text">Service Job</span>
                    </div>
                </button>
            </xpath>
            <xpath expr="//field[@name='origin_un_location_id']" position="attributes">
                <attribute name="attrs">{'invisible': ['|', ('mode_type', '=', False), ('mode_type', '=', 'land'), ('quote_for','!=','job')], 'required': [('mode_type', 'in', ['air', 'sea']),('quote_check', '!=', True)]}</attribute>
            </xpath>
            <xpath expr="//field[@name='destination_un_location_id']" position="attributes">
                <attribute name="attrs">{'invisible': ['|', ('mode_type', '=', False), ('mode_type', '=', 'land'), ('quote_for','!=','job')], 'required': [('mode_type', 'in', ['air', 'sea']),('quote_check', '!=', True)]}</attribute>
            </xpath>

            <xpath expr="//field[@name='port_of_loading_id']" position="attributes">
                <attribute name="attrs">{'invisible': ['|', ('mode_type', '=', False), ('mode_type', '=', 'land'), ('quote_for','!=','job')], 'required': [('mode_type', 'in', ['air', 'sea'])]}</attribute>
            </xpath>
            <xpath expr="//field[@name='port_of_discharge_id']" position="attributes">
                <attribute name="attrs">{'invisible': ['|', ('mode_type', '=', False), ('mode_type', '=', 'land'), ('quote_for','!=','job')], 'required': [('mode_type', 'in', ['air', 'sea'])]}</attribute>
            </xpath>

            <xpath expr="//label[@for='port_of_loading_id']/.." position="replace">
                <div class="o_td_label">
                    <label for="port_of_loading_id" string="Origin Port" attrs="{'invisible': ['|', ('mode_type', '=', False), ('mode_type', 'in', ['air', 'land'])]}"/>
                    <label for="port_of_loading_id" string="Origin Airport" attrs="{'invisible': ['|', ('mode_type', '=', False), ('mode_type', 'in', ['sea', 'land'])]}"/>
                    <label for="port_of_loading_id" string="Origin Port" attrs="{'invisible': [('quote_for','!=','job')]}"/>
                </div>
            </xpath>
            <xpath expr="//label[@for='port_of_discharge_id']/.." position="replace">
                <div class="o_td_label">
                    <label for="port_of_discharge_id" string="Destination Port" attrs="{'invisible': ['|', ('mode_type', '=', False), ('mode_type', 'in', ['air', 'land'])]}"/>
                    <label for="port_of_discharge_id" string="Destination Airport" attrs="{'invisible': ['|', ('mode_type', '=', False), ('mode_type', 'in', ['sea', 'land'])]}"/>
                    <label for="port_of_loading_id" string="Destination Port" attrs="{'invisible': [('quote_for','!=','job')]}"/>
                </div>
            </xpath>
        </field>
    </record>
</odoo>
