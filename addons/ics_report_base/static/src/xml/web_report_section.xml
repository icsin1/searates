<?xml version="1.0" encoding="utf-8"?>
<templates>

    <t t-name="WebReportSectionLine" owl="1">
        <tr t-attf-class="ics_report_base_line_level_{{section.level}} {{section.row_class or ''}} {{section.foldable ? 'ics_expandable_row' : ''}} {{section.parent_id ? 'd-none': ''}}" t-att-data-key="section.id" t-att-data-parent-key="section.parent_id">
            <td t-if="section.title" class="line_name">
                <div t-attf-class="d-flex {{section.action ? 'ics_clickable_action_section' : ''}}" t-att-data-key="section.id">
                    <t t-if="section.foldable">
                        <button class="btn btn_foldable btn-sm"><i class="fa fa-caret-right"></i></button>
                    </t>
                    <span t-esc="section.title"/>
                </div>
            </td>
            <t t-foreach="group_headers" t-as="group_header">
                <t t-foreach="headers" t-as="header" t-key="header">
                    <td t-attf-class="ics_column_value {{header.value_type}} {{group_header}} {{section.values[group_header][header.expression_label + '_is_zero'] ? 'ics_zero_value' : ''}} {{header.hide_if_zero ? 'ics_hide_zero' : ''}} p-1">
                        <div t-attf-class="{{section.action and section.title_key == header.expression_label ? 'ics_clickable_action_section line_name' : ''}}" t-att-data-key="section.id">
                            <t t-if="section.values[group_header][header.expression_label] and section.values[group_header][header.expression_label] != undefined" t-esc="section.values[group_header][header.expression_label]"/>
                        </div>
                    </td>
                </t>
            </t>
        </tr>
        <t t-if="section.children">
            <t t-foreach="section.children" t-as="section" t-key="section">
                <t t-call="WebReportSectionLine"/>
            </t>
        </t>
    </t>

    <t t-name="WebReportSection" owl="1">
        <div class="bg-white pt-2">
            <table class="ics_report_base_table table table-borderless table-hover striped sortable px-2">
                <thead>
                    <tr class="group_header" t-if="options.filter_date">
                        <th t-if="options.show_title"></th>
                        <th t-foreach="group_headers" t-as="group_header" t-att-colspan="headers.length" class="text-center p-2 border bg-100">
                            <t t-esc="group_headers[group_header].string"/>
                        </th>
                    </tr>
                    <tr>
                        <th t-if="options.show_title"></th>
                        <t t-foreach="group_headers" t-as="group_header">
                            <t t-foreach="headers" t-as="header" t-key="header_key">
                                <th t-attf-class="ics_report_base_column_header {{header.value_type}} {{header.sortable == true and 'sortable' or ''}} p-2">
                                    <button t-if="header.sortable"
                                            t-att-class="`btn btn_sortable fa ${header.reverse and header.orderby === header.expression_label? 'fa-arrow-down' :!header.reverse and header.orderby === header.expression_label? 'fa-arrow-up' : 'fa-arrows-v'}`"
                                    />
                                    <span class="label" t-att-data-expression-label="header.expression_label" t-att-data-key="header.id"><t t-esc="header.string"/></span>
                                </th>
                            </t>
                        </t>
                    </tr>
                </thead>
                <tbody>
                    <t t-foreach="sections" t-as="section" t-key="section">
                        <t t-call="WebReportSectionLine"/>
                    </t>
                </tbody>
            </table>
        </div>
    </t>

    <t t-name="ics_report_base.WebReportSectionGroupLine">
        <tr t-attf-class="ics_report_base_line_level_{{section.level}} {{section.row_class or ''}} {{section.foldable ? 'ics_expandable_row' : ''}}" t-att-data-key="section.id">
            <td t-if="section.title" class="line_name">
                <div t-attf-class="d-flex {{section.action ? 'ics_clickable_action_section' : ''}}" t-att-data-key="section.id">
                    <t t-if="section.foldable">
                        <button class="btn btn_foldable btn-sm"><i class="fa fa-caret-right"></i></button>
                    </t>
                    <t t-else="">
                        <button class="btn btn_foldable_empty btn-sm"></button>
                    </t>
                    <t t-if="section.action">
                        <a t-attf-href="#model={{section.action.res_model}}&amp;id={{section.res_id}}"><span t-esc="section.title"/></a>
                    </t>
                    <t t-else="">
                        <span t-esc="section.title"/>
                    </t>
                </div>
            </td>
            <t t-foreach="group_headers" t-as="group_header">
                <t t-foreach="headers" t-as="header" t-key="header">
                    <td t-attf-class="ics_column_value {{header.value_type}} {{group_header}} {{section.values[group_header][header.expression_label + '_is_zero'] ? 'ics_zero_value' : ''}} {{header.hide_if_zero ? 'ics_hide_zero' : ''}}">
                        <span><t t-if="section.values[group_header][header.expression_label] and section.values[group_header][header.expression_label] != undefined" t-esc="section.values[group_header][header.expression_label]"/></span>
                    </td>
                </t>
            </t>
        </tr>
        <t t-if="section.children">
            <t t-foreach="section.children || []" t-as="section" t-key="section">
                <t t-call="ics_report_base.WebReportSectionGroupLine"/>
            </t>
        </t>
    </t>
    <t t-name="ics_report_base.WebReportSectionLineContainer">
        <t t-foreach="lines" t-as="section" t-key="section">
            <t t-call="ics_report_base.WebReportSectionGroupLine"/>
        </t>
    </t>
</templates>
