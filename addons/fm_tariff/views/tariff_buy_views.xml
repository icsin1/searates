<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="tariff_buy_view_tree" model="ir.ui.view">
        <field name="name">tariff.buy.view.tree</field>
        <field name="model">tariff.buy</field>
        <field name="arch" type="xml">
            <tree decoration-bf="vendor_id == False">
                <field name="tariff_name" />
                <field name="vendor_id" />
                <field name="company_id"/>
                <field name="tariff_for"/>
                <field name="shipment_type_id"/>
                <field name="transport_mode_id"/>
                <field name="cargo_type_domain" invisible="1" />
                <field name="cargo_type_id" domain="cargo_type_domain"/>
                <field name="origin_id" />
                <field name="destination_id" />
                <field name="active_charge_count" />
                <field name="active" widget="boolean_toggle" invisible="1"/>
            </tree>
        </field>
    </record>

    <record id="tariff_buy_view_form" model="ir.ui.view">
        <field name="name">tariff.buy.view.form</field>
        <field name="model">tariff.buy</field>
        <field name="arch" type="xml">
            <form string="buy Tariff">
                <sheet>
                    <label for="tariff_name"/>
                    <div class="oe_title">
                        <h1><field name="tariff_name" placeholder="Tariff Name" force_save="1"/></h1>
                    </div>
                    <group>
                        <group>
                            <field name="tariff_for" widget="radio" options="{'horizontal': True}"/>
                            <field name="shipment_type_id" options="{'no_create': True, 'no_open': True}" attrs="{'required': [('tariff_for', '=', 'shipment')]}"/>
                            <field name="transport_mode_id" options="{'no_create': True, 'no_open': True}" attrs="{'required': [('tariff_for', '=', 'shipment')]}"/>
                        </group>
                        <group>
                            <field name="cargo_type_domain" invisible="1" />
                            <field name="cargo_type_id" domain="cargo_type_domain" options="{'no_create': True, 'no_open': True}" attrs="{'required': [('tariff_for', '=', 'shipment')]}"/>
                            <field name="company_id" options="{'no_create': True, 'no_open': True}"/>
                            <field name="domain_measurement_ids" invisible="1"/>
                            <field name="mode_type" invisible="1"/>
                            <div class="o_td_label">
                                <label for="carrier_id" string="Airline" attrs="{'invisible': [('mode_type', '!=', 'air')]}"/>
                                <label for="carrier_id" string="Carrier" attrs="{'invisible': [('mode_type', '!=', 'sea')]}"/>
                                <label for="carrier_id" string="Transporter" attrs="{'invisible': [('mode_type', '!=', 'land')]}"/>
                            </div>
                            <field name="carrier_id" nolabel="1" attrs="{'invisible': [('mode_type', '=', False)]}" options="{'no_create': True, 'no_open': True}"/>
                        </group>
                    </group>
                    <group string="General">
                        <group>
                            <field name="vendor_id" />
                        </group>
                        <group>
                            <field name="currency_id" options="{'no_create': True, 'no_open': True}" />
                            <field name="active" widget="boolean_toggle" invisible="1"/>
                        </group>
                    </group>
                    <group string="Location">
                        <group>
                            <field name="origin_country_id" attrs="{'invisible': [('transport_mode_type', '=', 'land')]}" readonly="0"/>
                            <field name="origin_id" domain="[('country_id', '=', origin_country_id)]" attrs="{'invisible': [('transport_mode_type', '=', 'land')]}"/>
                            <field name="origin_port_un_location_id" attrs="{'invisible': [('mode_type', '!=', 'air')]}"/>
                            <field name="origin_port_id" context="{'default_country_id': origin_country_id, 'default_transport_mode_id': transport_mode_id}" attrs="{'invisible': [('transport_mode_type', 'in', ['land', 'air', False])]}"/>
                            <field name="pickup_country_id" attrs="{'invisible': [('mode_type', '!=', 'land')]}"/>
                            <field name="pickup_location_type_id" attrs="{'invisible': [('mode_type', '!=', 'land')]}"/>
                            <field name="road_origin_un_location_id" string="Pickup Location" domain="[('has_road', '=', True), ('country_id', '=', pickup_country_id), ('location_type_id', '=', pickup_location_type_id)]"
                                   context="{'default_country_id': pickup_country_id, 'default_transport_mode_id': transport_mode_id, 'default_has_road': True, 'default_location_type_id': pickup_location_type_id}" attrs="{'invisible': [('mode_type', '!=', 'land')]}"/>
                        </group>
                         <group>
                            <field name="destination_country_id" attrs="{'invisible': [('transport_mode_type', '=', 'land')]}"  readonly="0"/>
                            <field name="destination_id" domain="[('country_id', '=', destination_country_id)]" attrs="{'invisible': [('transport_mode_type', '=', 'land')]}"/>
                            <field name="destination_port_un_location_id" attrs="{'invisible': [('mode_type', '!=', 'air')]}"/>
                            <field name="destination_port_id" context="{'default_country_id': destination_country_id, 'default_transport_mode_id': transport_mode_id}" attrs="{'invisible': [('transport_mode_type', 'in', ['land', 'air', False])]}"/>
                            <field name="delivery_country_id" attrs="{'invisible': [('mode_type', '!=', 'land')]}"/>
                            <field name="delivery_location_type_id" attrs="{'invisible': [('mode_type', '!=', 'land')]}"/>
                            <field name="road_destination_un_location_id" string="Delivery Location"
                                   domain="[('has_road', '=', True), ('country_id', '=', delivery_country_id), ('location_type_id', '=', delivery_location_type_id)]"
                                   context="{'default_country_id': delivery_country_id, 'default_transport_mode_id': transport_mode_id, 'default_has_road': True, 'default_location_type_id': delivery_location_type_id}" attrs="{'invisible': [('mode_type', '!=', 'land')]}"/>
                        </group>
                    </group>
                    <notebook>
                        <page name="tariff_line" string="Charges">
                            <field name="transport_mode_type" invisible="1"/>
                            <button name="download_error_message_file" string="Download Errors" type="object" class="btn btn-icon fa fa-bug float-right" attrs="{'invisible': [('import_error_message', '=', False)]}"/>
                            <field name="import_error_message" class="text-danger" attrs="{'invisible': [('import_error_message', '=', False)]}" readonly="1" force_save="1"/>
                            <div class="tariff_button_group d-inline-flex mr-2">
                                <button name="action_excel_download_charges_template" type="object" class="oe_highlight btn-icon mr-2 mb-2 fa fa-download" title="Download Charges Template"/>
                                <widget id="attach_document" name="attach_document" string="Upload Charges" action="action_excel_upload_charges" highlight="1" class="mb-2"/>
                                <button string="Fetch Charge Master" name="action_import_charges" type="object" class="oe_highlight btn-primary mb-2 ml-2"/>
                                <button string="Remove All" name="action_remove_charges" type="object" class="oe_highlight btn-danger btn-primary ml-2 mb-2" confirm="Are you sure want to delete all lines?"/>
                            </div>
                            <field name="line_ids" context="{'default_currency_id': currency_id}"/>
                            <div class="text-info text-right">** In case of same Charge Name found from Uploaded Charges file, Only Last valid row entry will be considered for import.</div>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <record id="tariff_buy_view_search" model="ir.ui.view">
        <field name="name">tariff.buy.view.search</field>
        <field name="model">tariff.buy</field>
        <field name="arch" type="xml">
            <search string="Tariff Buy">
                <field name="tariff_name"/>
                <field name="company_id" string="Company"/>
                <field name="shipment_type_id"/>
                <field name="transport_mode_id"/>
                <field name="cargo_type_id"/>
                <field name="tariff_for"/>
                <group expand="0" string="Group By">
                    <filter name="company_id" string="Company" context="{'group_by':'company_id'}"/>
                    <filter name="tariff_for" string="Type" context="{'group_by':'tariff_for'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="tariff_buy_line_view_tree" model="ir.ui.view">
        <field name="name">tariff.buy.line.view.tree</field>
        <field name="model">tariff.buy.line</field>
        <field name="arch" type="xml">
            <tree decoration-muted="not is_active_charge" decoration-success="is_active_charge">
                <field name="charge_type_id" domain="charge_domain"/>
                <field name="charge_domain" invisible="1"/>
                <field name="unit_price" />
                <field name="currency_id" />
                <field name="measurement_basis_id" domain="[('id', 'in' , parent.domain_measurement_ids)]"/>
                <field name="date_from" />
                <field name="date_to" />
                <field name="is_active_charge" invisible="1"/>
            </tree>
        </field>
    </record>

    <record id="tariff_buy_line_view_form" model="ir.ui.view">
        <field name="name">tariff.buy.line.view.form</field>
        <field name="model">tariff.buy.line</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <group string="Charge">
                            <field name="charge_domain" invisible="1"/>
                            <field name="charge_type_id" domain="charge_domain" options="{'no_create': True, 'no_open': True}"/>
                            <label for="unit_price"/>
                            <div class="o_row">
                                <field name="unit_price" />
                                <field name="currency_id" options="{'no_create': True, 'no_open': True}" class="oe_edit_only"/>
                            </div>
                            <field name="transport_mode_id" invisible="1"/>
                            <field name="cargo_type_id" invisible="1"/>
                            <field name="transport_mode_type" invisible="1"/>
                            <label for="measurement_basis_id" string="Measurement Basis"/>
                            <div class="o_row">
                                <field name="is_container_type_basis" invisible="1"/>
                                <field name="is_cargo_type" invisible="1"/>
                                <field name="is_container_type_basis" invisible="1"/>
                                <field name="measurement_basis_id" domain="[('id', 'in' , parent.domain_measurement_ids), ('transport_mode_ids', '=', transport_mode_id)]" options="{'no_create': True, 'no_open': True}" />
                                <field name="container_type_id" attrs="{'invisible': ['|','|',('is_container_type_basis', '=', False),('transport_mode_type', '!=', 'sea'), ('is_cargo_type', '=', False)], 'required': [('is_container_type_basis', '=', True),('transport_mode_type', '=', 'sea'), ('is_cargo_type', '=', True)]}" options="{'no_create': 1}"/>

                            </div>
                        </group>
                        <group string="Validity">
                            <field name="active" invisible="1"/>
                            <field name="company_id" invisible="1"/>
                            <label for="date_from"/>
                            <div class="o_row">
                                <field name="date_from" widget="daterange" nolabel="1" options="{'related_end_date': 'date_to'}"/> to
                                <field name="date_to" widget="daterange" nolabel="1" options="{'related_start_date': 'date_from'}"/>
                            </div>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="tariff_buy_action" model="ir.actions.act_window">
        <field name="name">Buy Tariff</field>
        <field name="res_model">tariff.buy</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[]</field>
    </record>
    <menuitem
        id="tariff_buy_menu"
        name="Buy Tariff"
        action="tariff_buy_action"
        parent="menu_tariff_root_menu"
        sequence="2"/>
</odoo>
