<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="fm_temp_party_crm_prospect_opportunity_view_form" model="ir.ui.view">
        <field name="name">fm_temp_party.crm_prospect_opportunity.view.form</field>
        <field name="model">crm.prospect.opportunity</field>
        <field name="inherit_id" ref="crm_prospect_lead.crm_prospect_opportunity_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//group[@name='party_details_left']" position="inside">
                <field name="enable_temp_party" invisible="1"/>
            </xpath>
            <xpath expr="//group[@name='party_details_left']/field[@name='customer_type']" position="after">
                <label for="temp_party_name" string="" attrs="{'invisible': [('enable_temp_party','!=',True)]}"/>
                <field name="temp_party_name" nolabel="1" attrs="{'invisible': [('enable_temp_party','!=',True)], 'required': [('enable_temp_party','=',True)]}"/>
            </xpath>
            <xpath expr="//group[@name='party_details_left']/label[@for='partner_id']" position="attributes">
                <attribute name="attrs">{'invisible': ['|',('enable_temp_party','=',True), ('opportunity_type', '!=', 'existing')]}</attribute>
            </xpath>
            <xpath expr="//group[@name='party_details_left']/field[@name='partner_id']" position="attributes">
                <attribute name="attrs">{'invisible': ['|',('enable_temp_party','=',True), ('opportunity_type', '!=', 'existing')], 
                        'required': ['&amp;', ('enable_temp_party','!=',True), ('opportunity_type', '=', 'existing')]}</attribute>
            </xpath>
            <xpath expr="//group[@name='party_details_left']/label[@for='prospect_id']" position="attributes">
                <attribute name="attrs">{'invisible': ['|',('enable_temp_party','=',True), ('opportunity_type', '!=', 'new')]}</attribute>
            </xpath>
            <xpath expr="//group[@name='party_details_left']/field[@name='prospect_id']" position="attributes">
                <attribute name="attrs">{'invisible': ['|',('enable_temp_party','=',True), ('opportunity_type', '!=', 'new')],
                        'required': ['&amp;', ('enable_temp_party','!=',True), ('opportunity_type', '=', 'new')]}</attribute>
            </xpath>
            <xpath expr="//group[@name='party_details_left']/field[@name='prospect_id']" position="after">
                <label for="temp_party_address" string="Address" attrs="{'invisible': [('enable_temp_party','!=',True)]}"/>
                <field name="temp_party_address" nolabel="1" attrs="{'invisible': [('enable_temp_party','!=',True)], 'required': [('enable_temp_party','=',True)]}"/>
            </xpath>
            <xpath expr="//group[@name='party_details_left']/label[@for='street1']" position="attributes">
                <attribute name="attrs">{'invisible':[('enable_temp_party', '=', True)]}</attribute>
            </xpath>
            <xpath expr="//group[@name='party_details_left']/div[hasclass('o_address_format')]" position="attributes">
                <attribute name="attrs">{'invisible':[('enable_temp_party', '=', True)]}</attribute>
            </xpath>
            <xpath expr="//group[@name='party_details_left']/div[hasclass('o_address_format')]/field[@name='street1']" position="attributes">
                <attribute name="attrs">{'required':[('enable_temp_party', '!=', True)]}</attribute>
                <attribute name="required">0</attribute>
            </xpath>
            <xpath expr="//group[@name='party_details_left']/div[hasclass('o_address_format')]/field[@name='country_id']" position="attributes">
                <attribute name="attrs">{'required':[('enable_temp_party', '!=', True)]}</attribute>
                <attribute name="required">0</attribute>
            </xpath>
        </field>
    </record>
</odoo>