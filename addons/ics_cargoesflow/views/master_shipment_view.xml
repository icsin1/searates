<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="freight_master_shipment_cargosflow_integration_view_form" model="ir.ui.view">
        <field name="name">freight.master.shipment.cargosflow.integration.view.form</field>
        <field name="model">freight.master.shipment</field>
        <field name="inherit_id" ref="freight_management.freight_master_shipment_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//header" position="inside">
                <button string="Sync with CargoesFlow"
                        name="action_sync_cargoflow_shipment"
                        type="object"
                        class="oe_highlight"
                        attrs="{'invisible': ['|', '|', ('synced_with_cargoflow', '=', True), ('mode_type', 'not in', ['air', 'sea']), ('house_shipment_count', '=', 0)]}"/>

                <button string="Create Cargoes Shipment"
                        name="action_submit_cargoflow_shipment"
                        type="object"
                        class="oe_highlight"
                        attrs="{'invisible': ['|', '|', ('submit_cargoflow_shipment', '=', True), ('mode_type', 'not in', ['air']), ('house_shipment_count', '=', 0)]}"/>

                <button string="Fetch Milestones"
                        name="action_update_milestones_for_shipment"
                        type="object"
                        class="oe_highlight"
                        attrs="{'invisible': ['|', ('synced_with_cargoflow', '=', False), ('mode_type', 'not in', ['sea','air'])]}"/>
            </xpath>
            <xpath expr="//page[@name='carrier_details']/group[last()]" position="after">
                <group string="Shipment Tracking" attrs="{'invisible': [('mode_type', 'not in', ['sea','air'])]}">
                    <group groups="base.group_no_one">
                        <field name="submit_cargoflow_shipment" attrs="{'invisible': [('mode_type','!=','air')]}"/>
                        <field name="synced_with_cargoflow" readonly="0" force_save="1"/>
                    </group>
                    <group>
                        <field name="shipment_tracking_url" widget="url" string="Tracking URL"/>
                    </group>
                </group>
            </xpath>

            <xpath expr="//page[@name='package_details']/field[@name='package_ids']/tree/field[@name='container_number']" position="after">
                <button type="object" name="action_shipment_milestone_container" icon="fa-chain" class="btn btn-primary" string="Milestones" attrs="{'invisible': [('container_number', '=', False)]}"/>
                <button type="object" name="action_track_shipment_milestone_container" icon="fa-long-arrow-right" class="btn btn-primary" string="Track" attrs="{'invisible': [('container_number', '=', False)]}"/>
                <field name="tracking_url" widget="url" invisible="1"/>
            </xpath>

            <xpath expr="//page[@name='package_details']/field[@name='container_ids']/tree/field[@name='container_number']" position="after">
                <button type="object" name="action_shipment_milestone_container" icon="fa-chain" class="btn btn-primary" string="Milestones" attrs="{'invisible': [('container_number', '=', False)]}"/>
                <button type="object" name="action_track_shipment_milestone_container" icon="fa-long-arrow-right" class="btn btn-primary" string="Track" attrs="{'invisible': [('container_number', '=', False)]}"/>
                <field name="tracking_url" widget="url" invisible="1"/>
            </xpath>
            <xpath expr="//page[@name='milestones']/field[@name='event_ids']" position="before">
                <button type="object" name="action_track_air_shipment"
                        class="btn btn-primary"
                        string="Track Shipment" attrs="{'invisible': [('mode_type', '!=', 'air')]}"/>
            </xpath>
            
        </field>
    </record>
</odoo>
